;/*FB_PKG_DELIM*/

__d("WADevToolsStanzaViewer",["WADevToolsBridge","WASmaxParseUtils","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var c=d("WASmaxParseUtils").attrInt(a,"t");c=c.success?d("WATimeUtils").castToUnixTime(c.value):d("WATimeUtils").unixTime();d("WADevToolsBridge").getDevToolBridge().fireAndForget("devtool","newStanza",{ts:c,type:a.tag,isOutgoing:b,stanza:a.toString()},!0)}g.sendNewStanzaToDevTool=a}),98);
__d("WAFingerprint.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({E2EE:0,HOSTED:1});c={};e={};c.internalSpec={publicKey:[1,(f=d("WAProtoConst")).TYPES.BYTES],pnIdentifier:[2,f.TYPES.BYTES],lidIdentifier:[3,f.TYPES.BYTES],usernameIdentifier:[4,f.TYPES.BYTES],hostedState:[5,f.TYPES.ENUM,a]};e.internalSpec={version:[1,f.TYPES.UINT32],localFingerprint:[2,f.TYPES.MESSAGE,c],remoteFingerprint:[3,f.TYPES.MESSAGE,c]};g.HostedState=a;g.FingerprintDataSpec=c;g.CombinedFingerprintSpec=e}),98);
__d("WAValidateFingerprints",["$InternalEnum","WACryptoUtils","WAFingerprint.pb","WANullthrows","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";var h=b("$InternalEnum").Mirrored(["SUCCESS","MALFORMED_CODE","UNEXPECTED_VERSION_OLD","UNEXPECTED_VERSION_NEW","REMOTE_WRONG_CHAT_PEER","REMOTE_WRONG_CHAT","LOCAL_WRONG_CHAT","LOCAL_KEYS_MISMATCH","REMOTE_KEYS_MISMATCH","LOCAL_PN_MISMATCH_PEER","LOCAL_PN_MISMATCH","REMOTE_PN_MISMATCH_PEER","REMOTE_PN_MISMATCH","REMOTE_PN_MISSING_PEER","REMOTE_PN_MISSING","LOCAL_USERNAME_MISMATCH_PEER","LOCAL_USERNAME_MISMATCH","LOCAL_USERNAME_MISSING_PEER","LOCAL_USERNAME_MISSING","REMOTE_USERNAME_MISMATCH_PEER","REMOTE_USERNAME_MISMATCH","REMOTE_USERNAME_MISSING_PEER","REMOTE_USERNAME_MISSING","REMOTE_HOSTED_DEVICE_MISSMATCH","LOCAL_HOSTED_DEVICE_MISSMATCH"]),i=0;function a(a,b,e,f){f===void 0&&(f=!1);a=d("decodeProtobuf").decodeProtobuf(d("WAFingerprint.pb").CombinedFingerprintSpec,a);b=d("decodeProtobuf").decodeProtobuf(d("WAFingerprint.pb").CombinedFingerprintSpec,b);if(!a||a.version==null)return h.MALFORMED_CODE;if(a.version<i)return h.UNEXPECTED_VERSION_OLD;else if(a.version>i)return h.UNEXPECTED_VERSION_NEW;var g=c("WANullthrows")(b.localFingerprint),k=g.pnIdentifier,l=g.lidIdentifier;b=c("WANullthrows")(b.remoteFingerprint);var m=b.pnIdentifier,n=b.lidIdentifier,o=a.localFingerprint;a=a.remoteFingerprint;if(!o||!a)return h.MALFORMED_CODE;var p=j(o.pnIdentifier,k),q=j(o.lidIdentifier,l);k=j(a.pnIdentifier,k);l=j(a.lidIdentifier,l);var r=!1;if(p||q){r=!0;p=o;q=j(a.pnIdentifier,m);var s=j(a.lidIdentifier,n);if(q||s)q=a;else return h.REMOTE_WRONG_CHAT_PEER}else if(k||l){p=a;s=j(o.pnIdentifier,m);k=j(o.lidIdentifier,n);if(s||k)q=o;else return h.REMOTE_WRONG_CHAT}else return h.LOCAL_WRONG_CHAT;if(!j(p.publicKey,g.publicKey))return h.LOCAL_KEYS_MISMATCH;if(!j(q.publicKey,b.publicKey))return h.REMOTE_KEYS_MISMATCH;l=j(p.pnIdentifier,g.pnIdentifier);if(p.pnIdentifier&&!l)return r?h.LOCAL_PN_MISMATCH_PEER:h.LOCAL_PN_MISMATCH;if(b.pnIdentifier)if(q.pnIdentifier){a=d("WACryptoUtils").arrayBuffersEqual(q.pnIdentifier,b.pnIdentifier);if(!a)return r?h.REMOTE_PN_MISMATCH_PEER:h.REMOTE_PN_MISMATCH}else return r?h.REMOTE_PN_MISSING_PEER:h.REMOTE_PN_MISSING;else if(q.pnIdentifier)return h.REMOTE_PN_MISSING;if(e){if(g.usernameIdentifier!=null)if(p.usernameIdentifier!=null){m=d("WACryptoUtils").arrayBuffersEqual(p.usernameIdentifier,g.usernameIdentifier);if(!m)return r?h.LOCAL_USERNAME_MISMATCH_PEER:h.LOCAL_USERNAME_MISMATCH}else return r?h.LOCAL_USERNAME_MISSING_PEER:h.LOCAL_USERNAME_MISSING;else if(p.usernameIdentifier!=null)return h.LOCAL_USERNAME_MISSING;if(b.usernameIdentifier!=null)if(q.usernameIdentifier!=null){n=d("WACryptoUtils").arrayBuffersEqual(q.usernameIdentifier,b.usernameIdentifier);if(!n)return r?h.REMOTE_USERNAME_MISMATCH_PEER:h.REMOTE_USERNAME_MISMATCH}else return r?h.REMOTE_USERNAME_MISSING_PEER:h.REMOTE_USERNAME_MISSING;else if(q.usernameIdentifier!=null)return h.REMOTE_USERNAME_MISSING}if(f){if(g.hostedState!==p.hostedState)return h.LOCAL_HOSTED_DEVICE_MISSMATCH;if(b.hostedState!==q.hostedState)return h.REMOTE_HOSTED_DEVICE_MISSMATCH}return h.SUCCESS}function j(a,b){return!a||!b?!1:d("WACryptoUtils").arrayBuffersEqual(a,b)}g.FingerprintValidationResult=h;g.validateFingerprint=a}),98);
__d("WAWebDownloadableLink.react",["WAWebFileSaver","WAWebUnstyledButton.react","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react"),j={button:{display:"x1lliihq",$$css:!0}};function a(a){var b=a.children,e=a.download,f=a.extension,g=a.file;return i.jsx(c("WAWebUnstyledButton.react"),{xstyle:j.button,onClick:function(){g!=null&&d("WAWebFileSaver").FileSaver.downloadData(g,e,f)},children:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebE2EChangeModal.react",["fbt","WAWebConfirmPopup.react","WAWebFbtCommon","WAWebFrontendContactGetters","WAWebModalManager","react","useWAWebContactValues"],(function(a,b,c,d,e,f,g,h){var i,j=i||c("react");function a(a){a=a.contact;a=d("useWAWebContactValues").useContactValues(a.id,[d("WAWebFrontendContactGetters").getFormattedShortName]);a=a[0];var b=function(){return d("WAWebModalManager").ModalManager.close()},e=c("WAWebFbtCommon")("OK");a=a;var f=h._("__JHASH__mg0WLhbekSW__JHASH__",[h._param("contactName",a)]);a=h._("__JHASH__dlq9x_V734l__JHASH__",[h._param("contactName",a)]);return j.jsx(d("WAWebConfirmPopup.react").ConfirmPopup,{title:f,onOK:b,okText:e,children:a})}a.displayName=a.name+" [from "+f.id+"]";g.E2eChangeModal=a}),226);
__d("WAWebProtobufsFingerprintV3.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({E2EE:0,HOSTED:1});c={};e={};c.internalSpec={publicKey:[1,(f=d("WAProtoConst")).TYPES.BYTES],pnIdentifier:[2,f.TYPES.BYTES],lidIdentifier:[3,f.TYPES.BYTES],usernameIdentifier:[4,f.TYPES.BYTES],hostedState:[5,f.TYPES.ENUM,a]};e.internalSpec={version:[1,f.TYPES.UINT32],localFingerprint:[2,f.TYPES.MESSAGE,c],remoteFingerprint:[3,f.TYPES.MESSAGE,c]};g.HostedState=a;g.FingerprintDataSpec=c;g.CombinedFingerprintSpec=e}),98);
__d("WAWebIdentityVerificationApi",["Promise","WABinary","WAJids","WALogger","WANullthrows","WAWebApiContact","WAWebBizCoexGatingUtils","WAWebIdentityApiUtils","WAWebManageE2ESessionsJob","WAWebProtobufsFingerprintV3.pb","WAWebSendMsgDatabaseJob","WAWebSignalProtocolStore","WAWebUserPrefsMeUser","WAWebUserPrefsMultiDevice","WAWebWidFactory","asyncToGeneratorRuntime","encodeProtobuf"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["getIdentityVerificationData: failed to generate identity QR code: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["getIdentityVerificationData: missing identity for device verification"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["ensureE2ESessions with error"]);k=function(){return a};return a}var l=/^([17]|2[07]|3[0123469]|4[013456789]|5[12345678]|6[0123456]|8[1246]|9[0123458]|\d{3})\d*?(\d{4,6})$/;function m(a){var b=l.exec(a.user);return d("WABinary").Binary.build(b?b[1]+b[2]:a.toString()).readByteArray()}function n(a){return d("WABinary").Binary.build(""+a.user+d("WAJids").LID_DOMAIN).readByteArray()}function o(a){return d("WABinary").Binary.build(a).readByteArray()}function p(a,b){a=a.getUint32(b,!1)*256+a.getUint8(b+4);return("00000"+a).slice(-5)}function q(a,b){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){a=(h||(h=b("Promise"))).resolve(d("WABinary").Binary.build(0,0,c,a).readByteArray());for(var e=0;e<5200;e++)a=a.then(function(a){return self.crypto.subtle.digest({name:"SHA-512"},d("WABinary").Binary.build(a,c).readByteArray())});e=(yield a);a=new DataView(e instanceof ArrayBuffer?e.slice(0,30):e.slice(0,30).buffer);return[p(a,0),p(a,5),p(a,10),p(a,15),p(a,20),p(a,25)].join("")});return r.apply(this,arguments)}function s(a,b,c,d){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,d,e){a=(yield (h||(h=b("Promise"))).all([q(a,c),q(d,e)]));return a.sort().join("")});return t.apply(this,arguments)}function u(a,b,e,f,g,h,i,j,k,l){var m;i={publicKey:i};f={publicKey:f};c("WANullthrows")((m=g)!=null?m:h,"Unexpected null: remotePnIdentifier ?? remoteLidIdentifier");c("WANullthrows")((m=a)!=null?m:b,"Unexpected null: localPnIdentifier ?? localLidIdentifier");g!=null&&(i.pnIdentifier=g);b!=null&&h!=null&&(i.lidIdentifier=h);a!=null&&(f.pnIdentifier=a);b!=null&&h!=null&&(f.lidIdentifier=b);e!=null&&(f.usernameIdentifier=e);j!=null&&(i.usernameIdentifier=j);d("WAWebBizCoexGatingUtils").hostedDeviceSecurityCodeVerificationEnabled()&&k&&(f.hostedState=d("WAWebProtobufsFingerprintV3.pb").HostedState.HOSTED);d("WAWebBizCoexGatingUtils").hostedDeviceSecurityCodeVerificationEnabled()&&l&&(i.hostedState=d("WAWebProtobufsFingerprintV3.pb").HostedState.HOSTED);m={version:0,localFingerprint:f,remoteFingerprint:i};g=new(d("WABinary").Binary)();d("encodeProtobuf").encodeProtobuf(d("WAWebProtobufsFingerprintV3.pb").CombinedFingerprintSpec,m,g);return g.readBuffer()}function a(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.jid,e=a.shareOwnPn;a=a.usernameSecurityCodeGenerationEnabled;var f=d("WAWebUserPrefsMeUser").assertGetMe(),g=d("WAWebUserPrefsMeUser").getMaybeMeLid(),l=d("WAWebUserPrefsMeUser").getMeUser(),p=(yield d("WAWebApiContact").getContactUsername(l)),q,r;c.isLid()?(q=c,r=d("WAWebApiContact").getPhoneNumber(d("WAWebWidFactory").toUserWid(q))):(q=d("WAWebApiContact").getCurrentLid(d("WAWebWidFactory").toUserWid(c)),r=c);var t=(yield d("WAWebApiContact").getContactUsername(c)),v=c.equals(l);c=(yield d("WAWebSendMsgDatabaseJob").getFanOutListJob([c,f],c));try{yield d("WAWebManageE2ESessionsJob").ensureE2ESessions(c)}catch(a){d("WALogger").ERROR(k()).devConsole(a)}var w=[],x=[],y=d("WAWebBizCoexGatingUtils").hostedDeviceSecurityCodeVerificationEnabled()?(yield d("WAWebUserPrefsMultiDevice").getIsHostedMeAccount())===!0:!1,z=!1;c.forEach(function(a){a.user===f.user&&!a.isHosted()&&x.push(a),(a.user!==f.user||v)&&(a.isHosted()?z=d("WAWebBizCoexGatingUtils").hostedDeviceSecurityCodeVerificationEnabled():w.push(a))});try{c=(yield d("WAWebIdentityApiUtils").getAllIdentityKeysBytesOrThrow(w));var A=(yield d("WAWebIdentityApiUtils").getAllIdentityKeysBytesOrThrow(x)),B=(yield d("WAWebSignalProtocolStore").getSignalProtocolStore().getIdentityKeyPair());if(!B){d("WALogger").WARN(j());return null}A.push(new Uint8Array(B.pubKey));v&&c.push(new Uint8Array(B.pubKey));B=d("WAWebIdentityApiUtils").identityKeysToBinary(A);A=d("WAWebIdentityApiUtils").identityKeysToBinary(c);c=e?m(l):null;e=r?m(r):null;l=g?n(g):null;r=q?n(q):null;g=a&&p!=null?o(p):null;q=a&&t!=null?o(t):null;p=c&&e?s(c,B,e,A):null;a=(yield (h||(h=b("Promise"))).all([h.resolve(p),u(c,l,g,B,e,r,A,q,y,z)]));t=a[0];p=a[1];return{binary:p,string:t}}catch(a){d("WALogger").WARN(i(),a);return null}});return v.apply(this,arguments)}g.getIdentityVerificationData=a}),98);
__d("WAWebIdentityVerificationJob",["WAJobOrchestratorTypes","WAWebIdentityVerificationApi","WAWebOrchestratorNonPersistedJob"],(function(a,b,c,d,e,f,g){function a(a,b){a=babelHelpers["extends"]({jid:a},b);return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getIdentityVerificationData",function(a){return d("WAWebIdentityVerificationApi").getIdentityVerificationData(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted(a)}g.getIdentityVerificationDataJob=a}),98);
__d("WAWebSendMsgToVerifyIdentityPopup.react",["fbt","WAWebConfirmPopup.react","WAWebEmojiText.react","WAWebFbtCommon","WAWebModalManager","react"],(function(a,b,c,d,e,f,g,h){var i,j=i||c("react");function a(a){var b=a.onOK,e=function(){d("WAWebModalManager").ModalManager.close(),b()};a=a.name||h._("__JHASH__c7a6LUyoJ8O__JHASH__");a=h._("__JHASH__JweW7kkiZVf__JHASH__",[h._param("name",a)]);return j.jsx(d("WAWebConfirmPopup.react").ConfirmPopup,{onOK:e,okText:c("WAWebFbtCommon")("OK"),children:j.jsx("div",{children:j.jsx(d("WAWebEmojiText.react").EmojiText,{text:a})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("WAWebTableRowCountsLogger",["WAAsyncSleep","WALogger","WAWebModelStorageUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["--------- Print Model Storage Tables End ---------"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([""," table row counts: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["--- Print Model Storage Tables Start ---"]);j=function(){return a};return a}function a(){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").DEV(j()).tags("storage-table-row-counts");var a=d("WAWebModelStorageUtils").getStorage().getExistingTables(),b=[],c=function*(a){b.push(yield d("WAWebModelStorageUtils").getStorage().table(a).count().then(function(b){return[a,b]})),yield d("WAAsyncSleep").asyncSleep(1e3)};for(a of a.keys())yield* c(a);for(c of b)d("WALogger").DEV(i(),c[0],c[1]).tags("storage-table-row-counts");d("WALogger").DEV(h()).tags("storage-table-row-counts")});return k.apply(this,arguments)}c={logStorageTableRowCounts:a};g["default"]=c}),98);
__d("WAWebVerificationDrawer.react",["fbt","WAByteArray","WAFilteredCatch","WAGetUserMedia","WALogger","WANullthrows","WAValidateFingerprints","WAWebAvatarOverlay.react","WAWebBizCoexGatingUtils","WAWebButton.react","WAWebContactCollection","WAWebContactGetters","WAWebCopyPasteSelectable.react","WAWebDownloadableLink.react","WAWebDrawer.react","WAWebDrawerBody.react","WAWebDrawerHeader.react","WAWebE2EChangeModal.react","WAWebEmojiText.react","WAWebExternalLink.react","WAWebFaqUrl","WAWebFbtCommon","WAWebFileSaverTypes","WAWebFrontendConstants","WAWebFrontendContactGetters","WAWebGuidePopup.react","WAWebIdentityVerificationJob","WAWebMediaCapture","WAWebMiscErrors","WAWebMobilePlatforms","WAWebModalManager","WAWebName.react","WAWebQRCode.react","WAWebSendMsgToVerifyIdentityPopup.react","WAWebSpinner.react","WAWebUserPrefsMeUser","WAWebUserPrefsMultiDevice","WAWebUsernameGatingUtils","WAWebVideo.react","WAWebWDSText.react","WAWebXAltIcon","jsqr","react","useWAWebContactValues","useWAWebInterval","useWAWebListener","useWAWebTimeout","useWAWebUIM","useWAWebUnmountSignal"],(function(a,b,c,d,e,f,g,h){var i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[IDQR] validation results"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["verificationString:render props.string should be "," characters long instead of ","."]);l=function(){return a};return a}e=j||d("react");var m=i||(i=c("react")),n=e.memo,o=e.useCallback,p=e.useEffect,q=e.useRef,r=e.useState,s={circle:{width:"xygnafs",height:"x1wkxgih",paddingTop:"x13zrc24",paddingEnd:"xbxaen2",paddingBottom:"x1t1ogtf",paddingStart:"x1u72gb5",$$css:!0},noWrap:{display:"x78zum5",overflowX:"x6ikm8r",overflowY:"x10wlt62",textOverflow:"xlyipyv",whiteSpace:"xuxw1ft",$$css:!0}},t=10,u=t/2;function v(a){var b=a.binary;a=a.contact;var e=r(!1),f=e[0],g=e[1];e=r(null);var i=e[0],j=e[1];e=o(function(a){a=a==null?void 0:a.getElementsByTagName("canvas")[0];if(!a){j(null);return}var b=document.createElement("canvas");b.width=a.width+t;b.height=a.height+t;var c=b.getContext("2d");c.fillStyle="white";c.fillRect(0,0,b.width,b.height);c.drawImage(a,u,u);b.toBlob(function(a){return j(a)},"image/png")},[j]);var k=d("WAWebUserPrefsMeUser").getMaybeMeUser(),l=null;if(f&&i&&k){f=d("WAWebFrontendContactGetters").getFormattedUser(a);a=d("WAWebFrontendContactGetters").getFormattedUser(d("WAWebContactCollection").ContactCollection.assertGet(k));k="Verification Code between "+a+" and "+f;l=m.jsx(c("WAWebDownloadableLink.react"),{file:i,download:k,extension:d("WAWebFileSaverTypes").AllowedFileExtensions.PNG,children:m.jsx(d("WAWebAvatarOverlay.react").AvatarOverlay,{text:h._("__JHASH__OBmxuYd7769__JHASH__")})})}return m.jsxs("div",{onMouseEnter:function(){return g(!0)},onMouseLeave:function(){return g(!1)},children:[l,m.jsx(d("WAWebQRCode.react").WAWebQRCode,{data:b,size:d("WAWebFrontendConstants").QR_EDGE/2,onChange:e,xstyle:s.circle})]})}v.displayName=v.name+" [from "+f.id+"]";function w(){return m.jsx("div",{className:"xygnafs x1wkxgih x13zrc24 xbxaen2 x1t1ogtf x1u72gb5",children:m.jsx("div",{className:"x13zrc24 xbxaen2 x1u72gb5 x1ej9moc",children:m.jsx(d("WAWebSpinner.react").Spinner,{size:52,stroke:4})})})}w.displayName=w.name+" [from "+f.id+"]";function x(a){var b=a.binary;a=a.contact;return m.jsx("div",{className:"x1n2onr6 x1y5idc5 xs3hcls xr1yuqi xkrivgy x4ii5y1 x1gryazu x6ikm8r x10wlt62 x14yjl9h xudhj91 x18nykt9 xww2gxu x1jpgh95 x9kwlzf x7v9bd0 x1alahoq x1hqk2wv",children:b?m.jsx(v,{binary:b,contact:a}):m.jsx(w,{})})}x.displayName=x.name+" [from "+f.id+"]";var y=3,z=4,A=5;function a(a){var b=function(){return y*z*A};if(a.string==null)return m.jsx("div",{children:h._("__JHASH__SWfdjl3NcY6__JHASH__")});a=a.string;if(a.length!==b()){d("WALogger").WARN(l(),b(),a.length);return m.jsx("div",{children:h._("__JHASH__9kc0TrTb3TB__JHASH__")})}b=[];for(var c=0;c<y;c++){var e=[];for(var f=0;f<z;f++){var g=[];for(var i=0;i<A;i++){var j=a.charAt(c*A*z+f*A+i);g.push(m.jsx("span",{className:"x1rg5ohu x10vfzb2",children:j},i))}e.push(m.jsx("span",{className:"x1rg5ohu x1hetxy2 xr1yuqi xkrivgy x4ii5y1 x1gryazu",children:g},f))}b.push(m.jsx(d("WAWebCopyPasteSelectable.react").SelectableDiv,{className:"x1hfn5x7 xr9ek0c xkrivgy xjpr12u x1gryazu x1f6kntn x1fc57z9 x4whq8f",selectable:!0,children:e},c))}return m.jsx(d("WAWebCopyPasteSelectable.react").SelectableDiv,{selectable:!0,children:b})}a.displayName=a.name+" [from "+f.id+"]";var aa=n(a,function(a,b){return b.string===a.string});function B(){return m.jsx("div",{className:"x1n2onr6 x1y5idc5 xs3hcls xr1yuqi xkrivgy x4ii5y1 x1gryazu x6ikm8r x10wlt62 x14yjl9h xudhj91 x18nykt9 xww2gxu x1jpgh95 x9kwlzf x7v9bd0 x1alahoq x14v0smp",children:m.jsx("div",{className:"x1n2onr6 xwa60dl x1svysek x7o08j2 x2b8uid x1cb1t30",children:"\u2713 "})})}B.displayName=B.name+" [from "+f.id+"]";function C(){return m.jsx("div",{className:"x1n2onr6 x1y5idc5 xs3hcls xr1yuqi xkrivgy x4ii5y1 x1gryazu x6ikm8r x10wlt62 x14yjl9h xudhj91 x18nykt9 xww2gxu x1jpgh95 x9kwlzf x7v9bd0 x1alahoq x1o43s8z",children:m.jsx("div",{className:"x1n2onr6 xwa60dl x1svysek x7o08j2 x2b8uid x1cb1t30",children:"!"})})}C.displayName=C.name+" [from "+f.id+"]";function D(a){a=a.children;return m.jsx("div",{className:"x10l6tqk xef1mmm x1ks9yow x9f619 xh8yej3 x889kno x1iji9kk x1a8lsjc x1sln4lm x1djn5p2 x1d3mw78 x7o08j2 x2b8uid x1kncwe2",children:a})}D.displayName=D.name+" [from "+f.id+"]";function E(a){var b=a.binary,c=a.contact;a=a.state;switch(a){case"qr":return m.jsx(x,{binary:b,contact:c});case"checkmark":return m.jsx(B,{});default:a;return m.jsx(C,{})}}E.displayName=E.name+" [from "+f.id+"]";var F=200;function G(a){var b=a.stream,e=a.onCapture,f=a.disposeStream,g=q(null),h=q(!1),i=q(null),j=q(null),k=function(){var a;a=(a=i.current)==null?void 0:a.underlyingVideo();if(!a)return;var b=document.createElement("canvas");b.width=a.videoWidth/2;b.height=a.videoHeight/2;var c=b.getContext("2d");c.drawImage(a,b.width/2,b.height/2,b.width,b.height,0,0,b.width,b.height);a=c.getImageData(0,0,b.width,b.height);e(a)};k=c("useWAWebInterval")(k,F);var l=k[0];p(function(){d("WAWebMediaCapture").isSrcObjectInVideoElement()||(g.current=window.URL.createObjectURL(b));return function(){if(!b)return;f==null?void 0:f();g.current!=null&&window.URL.revokeObjectURL(g.current)}},[]);var n=function(){var a;a=(a=i.current)==null?void 0:a.underlyingVideo();var b=j.current;if(!a||!b)return;var c=a.offsetHeight;a=a.offsetWidth;var d=a/3,e=d;a=(a-d)/2;c=(c-e)/2;b.style.width=d+"px";b.style.height=e+"px";b.style.margin=c+"px "+a+"px"};k=function(){if(h.current===!0)return;n();l()};d("useWAWebListener").useListener(window,"resize",n);var o=null;if(a.stream){o=m.jsxs("div",{className:"x1n2onr6 xh8yej3 xmgb6t1",children:[m.jsx("div",{className:"xpk2tj9 x1bndym7",children:m.jsx(c("WAWebVideo.react"),{autoPlay:!0,ref:i,onPlay:k,src:(k=g.current)!=null?k:void 0,srcObject:g.current!=null?void 0:a.stream,width:"100%"})}),m.jsx("div",{className:"x10l6tqk x13vifvy x14yjl9h xudhj91 x18nykt9 xww2gxu x1vrjhu8",ref:j}),m.jsx("button",{onClick:a.onClose,className:"x10l6tqk x1eu8d0j x160vmok xq22nx5",children:m.jsx(d("WAWebXAltIcon").XAltIcon,{})})]})}return o}G.displayName=G.name+" [from "+f.id+"]";var ba=3e3,ca=5e3,da=7e3,ea=1e3;e=m.forwardRef(b);function b(a,b){a=babelHelpers["extends"]({},a);var e=a.contact,f=a.onClose;a=a.isFirstLevel;a=a===void 0?!1:a;var g=c("useWAWebUIM")(),i=c("useWAWebUnmountSignal")(),j=d("useWAWebContactValues").useContactValues(e.id,[d("WAWebFrontendContactGetters").getVerificationBinary,d("WAWebFrontendContactGetters").getVerificationString,d("WAWebFrontendContactGetters").getFormattedUser,d("WAWebFrontendContactGetters").getFormattedShortName,d("WAWebContactGetters").getIsMe,d("WAWebContactGetters").getId,d("WAWebContactGetters").getShowBusinessCheckmarkAsPrimary,d("WAWebFrontendContactGetters").getPhoneNumber,d("WAWebFrontendContactGetters").getDisplayName,d("WAWebFrontendContactGetters").getShareOwnPn,d("WAWebFrontendContactGetters").getPnForLid,d("WAWebContactGetters").getIsHosted]);j[0];j[1];var l=j[2],n=j[3],t=j[4],u=j[5],v=j[6],w=j[7];j[8];var x=j[9],y=j[10];j=j[11];var z=q(null),A=q(null),B=q(null),C=r("qr"),F=C[0],H=C[1];C=r(null);var I=C[0],J=C[1];C=r(null);var K=C[0],L=C[1];C=r(!1);var ha=C[0],ia=C[1];C=r(null);var M=C[0],ja=C[1];C=r(null);var N=C[0],ka=C[1],la=function(){d("WAWebModalManager").ModalManager.open(m.jsx(c("WAWebSendMsgToVerifyIdentityPopup.react"),{name:l,onOK:function(){f?f():g==null?void 0:g.requestDismiss()}}))},O=function(){void d("WAWebIdentityVerificationJob").getIdentityVerificationDataJob(u,{shareOwnPn:x||!u.isLid()||d("WAWebUserPrefsMeUser").isMeAccount(u),usernameSecurityCodeGenerationEnabled:d("WAWebUsernameGatingUtils").usernameSecurityCodeGenerationEnabled()}).then(function(a){if(i.aborted)return;a?((!d("WAByteArray").compareArrayBuffer(M,a.binary)||!a.string===N)&&(M!=null&&d("WAWebModalManager").ModalManager.open(m.jsx(d("WAWebE2EChangeModal.react").E2eChangeModal,{contact:e})),ja(a.binary),ka(a.string)),na()):(oa(),la())})};C=d("useWAWebTimeout").useTimeout(o(function(){return J(null)},[J]),ca);var ma=C[0],P=function(a){H("qr"),J(a),ma()};C=function(){K&&I==null&&P(h._("__JHASH__OCsGkCXo1ch__JHASH__"))};var Q=d("useWAWebTimeout").useTimeout(O,ea),na=Q[0],oa=Q[1];Q=d("useWAWebTimeout").useTimeout(o(function(){return H("qr")},[H]),ba);var pa=Q[0];function R(a){S(),J(null),H(a),pa()}Q=d("useWAWebTimeout").useTimeout(C,da);var qa=Q[0];C=function(a){ia(a)};var ra=function(a){var b,c=n;switch(a){case d("WAValidateFingerprints").FingerprintValidationResult.UNEXPECTED_VERSION_OLD:b=h._("__JHASH__3qPnj8Qu7M7__JHASH__");break;case d("WAValidateFingerprints").FingerprintValidationResult.UNEXPECTED_VERSION_NEW:b=h._("__JHASH__Ah9f3uqQzGW__JHASH__");break;case d("WAValidateFingerprints").FingerprintValidationResult.REMOTE_WRONG_CHAT_PEER:b=h._("__JHASH__algg5lkEEky__JHASH__",[h._param("contact_name",c)]);break;case d("WAValidateFingerprints").FingerprintValidationResult.REMOTE_WRONG_CHAT:b=h._("__JHASH__YB0FywTazcl__JHASH__",[h._param("contact_name",c)]);break;case d("WAValidateFingerprints").FingerprintValidationResult.LOCAL_WRONG_CHAT:b=h._("__JHASH__rZCcwxXaGCG__JHASH__",[h._param("contact_name",c)]);break;case d("WAValidateFingerprints").FingerprintValidationResult.LOCAL_PN_MISMATCH:b=h._("__JHASH__ru_dtTCrWl7__JHASH__",[h._param("contact_name",c)]);break;case d("WAValidateFingerprints").FingerprintValidationResult.REMOTE_PN_MISMATCH:case d("WAValidateFingerprints").FingerprintValidationResult.REMOTE_PN_MISMATCH_PEER:case d("WAValidateFingerprints").FingerprintValidationResult.REMOTE_PN_MISSING_PEER:case d("WAValidateFingerprints").FingerprintValidationResult.REMOTE_PN_MISSING:b=h._("__JHASH__xvtb9Q0GLAe__JHASH__",[h._param("contact_name",c)]);break;case d("WAValidateFingerprints").FingerprintValidationResult.LOCAL_USERNAME_MISMATCH:case d("WAValidateFingerprints").FingerprintValidationResult.LOCAL_USERNAME_MISSING_PEER:case d("WAValidateFingerprints").FingerprintValidationResult.LOCAL_USERNAME_MISSING:b=h._("__JHASH__CQFIW1LGkIj__JHASH__",[h._param("contact_name",c)]);break;case d("WAValidateFingerprints").FingerprintValidationResult.REMOTE_USERNAME_MISMATCH_PEER:case d("WAValidateFingerprints").FingerprintValidationResult.REMOTE_USERNAME_MISMATCH:case d("WAValidateFingerprints").FingerprintValidationResult.REMOTE_USERNAME_MISSING_PEER:case d("WAValidateFingerprints").FingerprintValidationResult.REMOTE_USERNAME_MISSING:b=h._("__JHASH__BpDcLUVnTir__JHASH__",[h._param("contact_name",c)]);break;case d("WAValidateFingerprints").FingerprintValidationResult.MALFORMED_CODE:default:b=h._("__JHASH__EtaV-toWr1o__JHASH__");break}return b},S=function(){J(null),L(null),z.current=null},sa=function(a){a=ra(a);P(a)},T=function(a,b){a=fa(a);if(b&&!a)return;b=ga(a,c("WANullthrows")(M));d("WALogger").DEV(k()).devConsole(b);if(b===d("WAValidateFingerprints").FingerprintValidationResult.SUCCESS){R("checkmark");return}if(b===d("WAValidateFingerprints").FingerprintValidationResult.LOCAL_KEYS_MISMATCH||b===d("WAValidateFingerprints").FingerprintValidationResult.REMOTE_KEYS_MISMATCH||b===d("WAValidateFingerprints").FingerprintValidationResult.LOCAL_PN_MISMATCH_PEER||b===d("WAValidateFingerprints").FingerprintValidationResult.REMOTE_HOSTED_DEVICE_MISSMATCH||b===d("WAValidateFingerprints").FingerprintValidationResult.LOCAL_HOSTED_DEVICE_MISSMATCH||b===d("WAValidateFingerprints").FingerprintValidationResult.LOCAL_USERNAME_MISMATCH_PEER){R("error");return}sa(b)};Q=function(a){a.stopPropagation(),U(a.target.files)};var U=function(a){if(!a||!a[0])return;a=a[0];ta(a);a=A.current;a&&a.reset()},ta=function(a){var b=URL.createObjectURL(a),c=document.createElement("canvas"),d=c.getContext("2d"),e=new Image();e.src=b;e.onload=function(){c.width=e.width;c.height=e.height;d.drawImage(e,0,0);var a=d.getImageData(0,0,e.width,e.height);T(a,!1);window.URL.revokeObjectURL(b)}},ua=function(a){M&&(a.stopPropagation(),U(a.dataTransfer.files))},va=function(a){H("qr"),L(a),qa()},wa=function(a){a=d("WAWebMediaCapture").start("camera");var b=a.asyncStream;a=a.disposeStream;z.current=a;b.then(function(a){return va(a)})["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebMiscErrors").GetUserMedia.NotAllowedError,function(){d("WAWebModalManager").ModalManager.open(m.jsx(d("WAWebGuidePopup.react").GuidePopup,{messaging:d("WAWebGuidePopup.react").Messaging.CAMERA_FAIL,type:d("WAWebGuidePopup.react").GuidePopupType.GUIDE_UNBLOCK}))}))["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebMiscErrors").GetUserMedia.GetUserMediaError,function(){d("WAWebModalManager").ModalManager.open(m.jsx(d("WAWebGuidePopup.react").GuidePopup,{messaging:d("WAWebGuidePopup.react").Messaging.CAMERA_MISSING,type:d("WAWebGuidePopup.react").GuidePopupType.GUIDE_NONE}))}))},xa=function(a){T(a,!0)},ya=function(){var a=B.current;a==null?void 0:a.click()},V=function(a){f?f():g==null?void 0:g.requestDismiss()};p(function(){O();return function(){z.current==null?void 0:z.current()}},[]);y=h._("__JHASH__bP8qCjusaNZ__JHASH__",[h._param("formatted_name",y)]);var W=null,X=null,Y=null;w=u.isLid()&&(w==null||x!==!0);w?w=y:w=h._("__JHASH__F5aYtNEAf3B__JHASH__",[h._param("contactName",n)]);t&&(w=h._("__JHASH__ME2paqemS_O__JHASH__"));d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(d("WAWebMobilePlatforms").isSMB()&&d("WAWebUserPrefsMultiDevice").getIsHostedMeAccountFromLocalStorage()===!0?t?w=h._("__JHASH__Utxp20d2h3i__JHASH__"):w=h._("__JHASH__aulcsuRTvX8__JHASH__"):j===!0&&(w=h._("__JHASH__7SGFwKWsptQ__JHASH__")));M&&(d("WAGetUserMedia").getUserMedia&&(W=m.jsx("div",{className:"xjv05ge x2b8uid x13mwh8y x1q3qbx4 x1alahoq",children:K!=null?m.jsx(c("WAWebButton.react"),{type:"primary",onClick:S,children:h._("__JHASH__FPei_ES2RUx__JHASH__")}):m.jsx(c("WAWebButton.react"),{type:"primary",onClick:wa,children:h._("__JHASH__nfkklzkW2V2__JHASH__")})})),X=m.jsxs("div",{className:"xjv05ge x2b8uid x13mwh8y x1q3qbx4 x1alahoq",children:[m.jsx(c("WAWebButton.react"),{type:"primary",onClick:ya,children:h._("__JHASH__HXf9zFLg6zP__JHASH__")}),ha&&m.jsx("div",{className:"x78zum5 xl56j7k x6s0dn4 x1jchvi3 x2b8uid x10l6tqk x13vifvy xds687c x1ey2m1c x17qophe x1417sbz",children:h._("__JHASH__kUg0tsLRtNH__JHASH__")})]}),Y=m.jsx("form",{ref:A,method:"POST",children:m.jsx("input",{ref:B,accept:"image/*",type:"file",style:{display:"none"},onChange:Q,onClick:function(a){return a.stopPropagation()}})}));y=K&&m.jsx(G,{stream:K,disposeStream:z.current,onCapture:xa,onClose:S});var Z,$;a?Z=V:$=V;j=m.jsx(d("WAWebName.react").Name,{contact:e,showBusinessCheckmark:v,titlify:!0,ellipsify:!0,showMessageYourselfName:!0});return m.jsxs(c("WAWebDrawer.react"),{ref:b,onDrop:ua,onDragChange:C,children:[m.jsxs(d("WAWebDrawerHeader.react").DrawerHeader,{type:d("WAWebDrawerHeader.react").DRAWER_HEADER_TYPE.SMALL,rtlFixIfOnDarwin:!0,onBack:$,onCancel:Z,children:[m.jsx(d("WAWebWDSText.react").WDSTextTitle,{children:m.jsx(d("WAWebEmojiText.react").EmojiText,{text:h._("__JHASH__lMmkSKjYPXR__JHASH__")})}),m.jsx(d("WAWebWDSText.react").WDSTextSmall,{xstyle:s.noWrap,children:t?j:m.jsx(d("WAWebEmojiText.react").EmojiText,{text:h._("__JHASH__kcCUVLL_Ntf__JHASH__",[h._param("contact-name",l)]),ellipsify:!0})})]}),y,I!=null&&m.jsx(D,{children:I}),m.jsx(c("WAWebDrawerBody.react"),{children:m.jsxs("div",{className:"x1c4vz4f x2lah0s xdl72j9 xupuyjj x1w3bhph xn03hsr",children:[m.jsx("div",{className:"x78zum5 xl56j7k xjv05ge x1chd833 x1jpgh95 xyt666n x7v9bd0 x1alahoq",children:m.jsx(E,{state:F,binary:M,contact:e})}),m.jsx("div",{className:"xjv05ge x2b8uid x13mwh8y x1q3qbx4 x1alahoq",children:m.jsx("div",{className:"x14vqqas x2b8uid",dir:"ltr",children:N!=null&&m.jsx(aa,{string:N})})}),m.jsx("div",{className:"xjv05ge x2b8uid x13mwh8y x1q3qbx4 x1alahoq",children:m.jsxs("p",{className:"x1f6kntn x1fc57z9 x16cd2qt x2b8uid",children:[m.jsxs("span",{children:[w,"\xa0"]}),m.jsx(d("WAWebExternalLink.react").ExternalLink,{href:d("WAWebFaqUrl").getE2EFaqUrl(),children:c("WAWebFbtCommon")("Learn more")})]})}),W,X,Y]})})]})}b.displayName=b.name+" [from "+f.id+"]";n=e;function fa(a){a=c("jsqr")(a.data,a.width,a.height,{inversionAttempts:"dontInvert"});return!a?null:Uint8Array.from(a.binaryData)}function ga(a,b){if(!a)return d("WAValidateFingerprints").FingerprintValidationResult.MALFORMED_CODE;try{return d("WAValidateFingerprints").validateFingerprint(a,new Uint8Array(b),d("WAWebUsernameGatingUtils").usernameSecurityCodeVerificationEnabled(),d("WAWebBizCoexGatingUtils").hostedDeviceSecurityCodeVerificationEnabled())}catch(a){return d("WAValidateFingerprints").FingerprintValidationResult.MALFORMED_CODE}}g["default"]=n}),226);